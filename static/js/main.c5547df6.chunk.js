(this["webpackJsonpthe-cms"]=this["webpackJsonpthe-cms"]||[]).push([[0],{802:function(e,t,n){},803:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),c=n(18),r=n.n(c),o=n(86),s=n(856),l=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function d(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var u,h=n(57),f=n(42),b=n.n(f),j=n(113),p=n(71),m=n(64),g=n(65),O=n(114),x=n.n(O);!function(e){e.API_URL="https://radiant-sea-35276.herokuapp.com/api"}(u||(u={}));var v,w=new(function(){function e(){Object(m.a)(this,e)}return Object(g.a)(e,[{key:"createNewPost",value:function(e){var t={url:"".concat(u.API_URL,"/posts"),headers:{"Content-Type":"application/json"},data:e};return new Promise((function(e,n){x()(Object(p.a)(Object(p.a)({},t),{},{method:"POST"})).then((function(t){e(t.data)})).catch((function(e){n(e)}))}))}},{key:"editPost",value:function(e,t){var n={url:"".concat(u.API_URL,"/posts/").concat(e),headers:{"Content-Type":"application/json"},data:t};return new Promise((function(e,t){x()(Object(p.a)(Object(p.a)({},n),{},{method:"PUT"})).then((function(t){e(t.data)})).catch((function(e){return t(e)}))}))}},{key:"deletePost",value:function(e){var t={url:"".concat(u.API_URL,"/posts/").concat(e),headers:{"Content-Type":"application/json"}};return new Promise((function(e,n){x()(Object(p.a)(Object(p.a)({},t),{},{method:"DELETE"})).then((function(t){return e(t.data)})).catch((function(e){console.error(e),n(e)}))}))}},{key:"getPosts",value:function(e){var t={url:e?"".concat(u.API_URL,"/posts/").concat(e):"".concat(u.API_URL,"/posts"),headers:{"Content-Type":"application/json"}};return new Promise((function(e,n){x()(Object(p.a)(Object(p.a)({},t),{},{method:"GET"})).then((function(t){e(t.data)})).catch((function(e){return n(e)}))}))}}]),e}());!function(e){e.CREATE_POST="/create-post",e.EDIT_POST="/edit-post",e.HOME="/",e.MANAGE_POSTS="/manage-posts"}(v||(v={}));var P=Object(h.b)("getPostsFromAPI",function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.getPosts(t&&t);case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y=Object(h.b)("createNewPost",function(){var e=Object(j.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.stringify(t),e.next=3,w.createNewPost(n);case 3:window.location.replace(v.MANAGE_POSTS);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),C=Object(h.b)("editPost",function(){var e=Object(j.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.stringify(t.post),e.next=3,w.editPost(t.id,n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),k=Object(h.b)("deletePost",function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.deletePost(t).then((function(){return I.dispatch(P())}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),T=Object(h.c)({name:"PostsManager",initialState:{posts:[],selectedPost:null,status:"idle"},reducers:{setSelectedPost:function(e,t){var n=e.posts.filter((function(e){return e._id===t.payload}));e.selectedPost=n[0]}},extraReducers:function(e){e.addCase(P.pending,(function(e){e.status="loading"})).addCase(P.fulfilled,(function(e,t){e.status="idle",e.posts=t.payload}))}}),S=T.actions.setSelectedPost,E=function(e){return e.postsManager.posts},A=function(e){return e.postsManager.selectedPost},_=T.reducer,N=Object(h.c)({name:"EditPost",initialState:{post:null,status:"idle"},reducers:{},extraReducers:function(e){e.addCase(y.pending,(function(e){e.status="loading"})).addCase(y.fulfilled,(function(e){e.status="idle"})).addCase(C.pending,(function(e){e.status="loading"})).addCase(C.fulfilled,(function(e){e.status="idle"})).addCase(k.pending,(function(e){e.status="loading"})).addCase(k.fulfilled,(function(e){e.status="idle"}))}}).reducer,I=Object(h.a)({reducer:{editPost:N,postsManager:_}}),R=n(859),M=n(325),D=n(176),U=n.n(D),W=n(210),B=n(309),L=function(e){var t=e.safeDirection,n=e.safePadding,a=e.safeSpacing,i=e.safeFillContainer;return Object(W.a)((function(e){return Object(B.a)({root:{display:"flex",flexDirection:t,flexWrap:"wrap",padding:n,marginRight:"column"===t?-a:0,marginBottom:"row"===t?-a:0,width:"100%"},withBackground:{background:e.palette.background.paper},mainColumn:{margin:"auto !important",maxWidth:e.breakpoints.values.lg},childColumn:{flex:i?"1":"unset",flexDirection:t,marginBottom:a,"& :last-of-type":{marginBottom:0}},childRow:{flex:i?"1":"unset",flexDirection:t,marginBottom:a,marginRight:a,"& :last-of-type":{marginRight:0}}})}))},F=n(47),G=n(8),H=function e(t){var n=t.direction,c=t.padding,r=t.spacing,o=t.background,s=(t.elevation,t.fillContainer),l=t.mainColumn,d=t.children,u=n||"column",h=c?function(e){switch(e){case"0":case 0:return"0";case"16":case 16:return"16px";case"32":case 32:return"32px";default:return"0"}}(c):"0",f=r||0,b=o||!1,j=s||!1,p=l||!1,m=Object(F.a)(),g=L({safeDirection:u,safeFillContainer:j,safePadding:h,safeSpacing:f})(m),O=a.Children.map(d,(function(t){if(null!==t)return i.a.isValidElement(t)&&t.type===e?t:Object(G.jsx)("div",{className:U()(u&&"row"===u?g.childRow:g.childColumn,b&&g.withBackground),children:t})}));return Object(G.jsx)("div",{className:U()(g.root,u&&"row"===u?g.childRow:g.childColumn,b&&g.withBackground,p&&g.mainColumn),children:O})},J=n(852),V=n(853),z=n(854),Y=n(855),q=n(851),K=n(101),$=function(e){var t=e.children,n=e.disabled,a=e.target,i=e.url;return Object(G.jsx)(q.a,{href:i,target:a,children:Object(G.jsx)(K.a,{disabled:n,children:t})})},Q=function(){return Object(G.jsx)(G.Fragment,{children:Object(G.jsx)(J.a,{color:"secondary",elevation:0,children:Object(G.jsx)(H,{mainColumn:!0,children:Object(G.jsxs)(V.a,{variant:"dense",children:[Object(G.jsx)($,{children:Object(G.jsx)(z.a,{color:"primary"}),url:v.HOME}),Object(G.jsx)($,{children:Object(G.jsx)(Y.a,{color:"primary"}),url:v.MANAGE_POSTS})]})})})})},X=n(175),Z=n(27),ee=n(10),te=n(89),ne=function(e){var t=e.actions,n=Object(a.useState)(!1),i=Object(ee.a)(n,2),c=i[0],r=i[1];return Object(G.jsx)(H,{spacing:8,direction:"row",children:t.map((function(e,t){return e.href?c?Object(G.jsx)(Z.a,{to:{pathname:e.href,state:I.getState()}}):Object(G.jsx)(te.a,{variant:"contained",color:"primary",onClick:function(){return r(!0)},children:e.label},t):0===t?Object(G.jsx)(te.a,{variant:"contained",color:"primary",onClick:e.callback,children:e.label},t):Object(G.jsx)(te.a,{variant:"contained",color:"secondary",onClick:e.callback,children:e.label},t)}))})},ae=function(e){var t=e.title,n=e.actions;return Object(G.jsxs)(H,{spacing:32,padding:32,background:!0,elevation:!0,children:[Object(G.jsx)(M.a,{variant:"h2",children:t}),n&&Object(G.jsx)(ne,{actions:n})]})},ie=function(e){var t=e.children;return Object(G.jsx)(H,{spacing:32,padding:32,direction:"column",background:!0,elevation:!0,children:t})},ce=[{href:v.CREATE_POST,label:"Create New Post"}],re=n(314),oe=function(e){var t=e.id;return[{href:v.EDIT_POST,label:"Edit"},{callback:function(){I.dispatch(k(t))},label:"Delete"}]},se=[{field:"postTitle",headerName:"Post Title",width:160},{field:"friendlyCreateDate",headerName:"Created",width:240},{field:"thumbnailUrl",headerName:"Thumbnail Image Url",width:160},{field:"postContent",headerName:"Post Content",width:600}],le=Object(W.a)({table:{height:432}}),de=function(){return Object(o.b)()},ue=o.c,he=function(){var e=de(),t=ue(E),n=ue(A),a=t.map((function(e){return{id:e._id,postContent:e.content,postTitle:e.title,friendlyCreateDate:e.friendly_create_date,thumbnailUrl:e.thumbnailImage}})),i=le();return t?Object(G.jsxs)(H,{spacing:16,children:[n&&Object(G.jsx)(ne,{actions:oe({id:n._id})}),Object(G.jsx)("div",{className:i.table,children:Object(G.jsx)(re.a,{columns:se,rows:a,pageSize:6,onRowClick:function(t){e(S(t.id))}})})]}):null},fe={footer:{copyright:"Copyright 2021 hmm.xd"},postManager:{editPost:{createPost:"Create post",editPost:"Edit post",updatePost:"Update post"},header:"Posts manager",managePosts:"Manage your posts",managePostsDesc:"Here you can make changes to your posts, arrange them or delete them."}},be=function(){var e=de(),t=fe.postManager;return Object(a.useEffect)((function(){e(P())})),Object(G.jsxs)(H,{spacing:32,children:[Object(G.jsx)(ae,{title:t.header,actions:ce}),Object(G.jsx)(ie,{children:Object(G.jsx)(H,{spacing:32,children:Object(G.jsxs)(H,{spacing:16,children:[Object(G.jsx)(M.a,{variant:"h4",children:t.managePosts}),Object(G.jsx)(M.a,{variant:"body1",children:t.managePostsDesc}),Object(G.jsx)(he,{})]})})})]})},je=n(191),pe=n(180),me=n.n(pe),ge=n(320),Oe=n.n(ge),xe=n(323),ve=function(e){var t=e.isCreate,n=e.isEdit,a=e.selectedPost,i=de();return Object(xe.a)({initialValues:n&&a?{content:a.content,thumbnailImage:a.thumbnailImage,title:a.title,"images[0]":a.images[0]}:{content:"",thumbnailImage:"",title:"","images[0]":""},onSubmit:function(e){var n=e,c={id:a?a._id:"id_unknown",post:e};i(t?y(n):C(c))}})},we=[{href:v.MANAGE_POSTS,label:"Back"}],Pe=Object(W.a)((function(e){return Object(B.a)({editor:{"& > div":{minHeight:"100vh",overflowY:"scroll",padding:32},height:"100vh",overflowY:"hidden"}})})),ye=function(e){var t=e.usage,n=Object(o.c)(A),a="create"===t,i=ve({isCreate:a,isEdit:"edit"===t,selectedPost:n}),c=fe.postManager.editPost,r=a?c.createPost:c.editPost,s=a?c.createPost:c.updatePost,l=Object(F.a)(),d=Pe(l);return Object(G.jsxs)(H,{spacing:32,children:[Object(G.jsx)(ae,{title:r,actions:we}),Object(G.jsx)("form",{onSubmit:i.handleSubmit,className:"form",children:Object(G.jsxs)(H,{spacing:16,children:[Object(G.jsx)(je.a,{onChange:i.handleChange,id:"title",name:"title",type:"title",value:i.values.title,variant:"outlined",label:"Title",required:!0,fullWidth:!0}),Object(G.jsx)(je.a,{onChange:i.handleChange,id:"thumbnailImage",name:"thumbnailImage",type:"thumbnailImage",value:i.values.thumbnailImage,variant:"outlined",label:"Thumbnail Image URL",fullWidth:!0}),Object(G.jsx)(Oe.a,{appKey:"a0kj2d0xe9aw6se",success:function(e){return window.navigator.clipboard.writeText(e[0].link)},cancel:function(){return console.log("closed")},multiselect:!0,children:Object(G.jsx)(te.a,{type:"button",children:"Dropbox"})}),Object(G.jsx)(me.a,{className:d.editor,defaultValue:i.values.content,dark:!0,autoFocus:!0,onChange:function(e){i.values.content=e()}}),Object(G.jsx)(te.a,{fullWidth:!0,variant:"outlined",color:"primary",type:"submit",size:"large",children:s}),Object(G.jsx)(me.a,{readOnly:!0,value:i.values.content,dark:!0,className:d.editor})]})})]})},Ce=function(){return Object(G.jsx)(X.a,{children:Object(G.jsxs)(Z.d,{children:[Object(G.jsx)(Z.b,{exact:!0,path:v.MANAGE_POSTS,children:Object(G.jsx)(be,{})}),Object(G.jsx)(Z.b,{exact:!0,path:v.CREATE_POST,children:Object(G.jsx)(ye,{usage:"create"})}),Object(G.jsx)(Z.b,{exact:!0,path:v.EDIT_POST,children:Object(G.jsx)(ye,{usage:"edit"})}),Object(G.jsx)(Z.b,{exact:!0,path:v.HOME})]})})},ke=function(){return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsx)(R.a,{}),Object(G.jsxs)(H,{spacing:80,mainColumn:!0,children:[Object(G.jsx)(Q,{}),Object(G.jsx)(Ce,{}),Object(G.jsx)(H,{spacing:32,padding:32,background:!0,children:Object(G.jsx)(M.a,{variant:"caption",children:fe.footer.copyright})})]})]})},Te=n(93),Se=Object(Te.a)({overrides:{MuiIcon:{colorPrimary:{color:"#80d8ff"}},MuiToolbar:{dense:{justifyContent:"right"}}},palette:{primary:{contrastText:"#1b1b1b",main:"#80d8ff"},secondary:{contrastText:"#efefef",main:"#1b1b1b"},background:{default:"#1b1b1b",paper:"#2b2b2b"},text:{primary:"#eeeeee",secondary:"#dddddd"}},typography:{fontFamily:["Poppins","sans-serif"].join(",")}});n(802);r.a.render(Object(G.jsx)(i.a.StrictMode,{children:Object(G.jsx)(o.a,{store:I,children:Object(G.jsx)(s.a,{theme:Se,children:Object(G.jsx)(ke,{})})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/the-cms-public",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/the-cms-public","/service-worker.js");l?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):d(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):d(t,e)}))}}()}},[[803,1,2]]]);
//# sourceMappingURL=main.c5547df6.chunk.js.map