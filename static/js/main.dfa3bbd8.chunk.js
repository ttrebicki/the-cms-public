(this["webpackJsonpthe-cms"]=this["webpackJsonpthe-cms"]||[]).push([[0],{801:function(e,t,n){},802:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(18),c=n.n(r),o=n(86),s=n(855),l=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function d(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var u,h=n(57),f=n(42),b=n.n(f),j=n(113),p=n(71),g=n(64),m=n(65),O=n(114),v=n.n(O);!function(e){e.API_URL="https://radiant-sea-35276.herokuapp.com/api"}(u||(u={}));var x,w=new(function(){function e(){Object(g.a)(this,e)}return Object(m.a)(e,[{key:"createNewPost",value:function(e){var t={url:"".concat(u.API_URL,"/posts"),headers:{"Content-Type":"application/json"},data:e};return new Promise((function(e,n){v()(Object(p.a)(Object(p.a)({},t),{},{method:"POST"})).then((function(t){e(t.data)})).catch((function(e){n(e)}))}))}},{key:"editPost",value:function(e,t){var n={url:"".concat(u.API_URL,"/posts/").concat(e),headers:{"Content-Type":"application/json"},data:t};return new Promise((function(e,t){v()(Object(p.a)(Object(p.a)({},n),{},{method:"PUT"})).then((function(t){e(t.data)})).catch((function(e){return t(e)}))}))}},{key:"deletePost",value:function(e){var t={url:"".concat(u.API_URL,"/posts/").concat(e),headers:{"Content-Type":"application/json"}};return new Promise((function(e,n){v()(Object(p.a)(Object(p.a)({},t),{},{method:"DELETE"})).then((function(t){return e(t.data)})).catch((function(e){console.error(e),n(e)}))}))}},{key:"getPosts",value:function(e){var t={url:e?"".concat(u.API_URL,"/posts/").concat(e):"".concat(u.API_URL,"/posts"),headers:{"Content-Type":"application/json"}};return new Promise((function(e,n){v()(Object(p.a)(Object(p.a)({},t),{},{method:"GET"})).then((function(t){e(t.data)})).catch((function(e){return n(e)}))}))}}]),e}());!function(e){e.CREATE_POST="/create-post",e.EDIT_POST="/edit-post",e.HOME="/",e.MANAGE_POSTS="/manage-posts"}(x||(x={}));var P=Object(h.b)("getPostsFromAPI",function(){var e=Object(j.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.getPosts(t&&t);case 2:return n=e.sent,a=n.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y=Object(h.b)("createNewPost",function(){var e=Object(j.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.stringify(t),e.next=3,w.createNewPost(n);case 3:window.location.replace(x.MANAGE_POSTS);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),C=Object(h.b)("editPost",function(){var e=Object(j.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.stringify(t.post),e.next=3,w.editPost(t.id,n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),k=Object(h.b)("deletePost",function(){var e=Object(j.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.deletePost(t).then((function(){return N.dispatch(P())}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),T=Object(h.c)({name:"PostsManager",initialState:{posts:[],selectedPost:null,status:"idle"},reducers:{setSelectedPost:function(e,t){var n=e.posts.filter((function(e){return e._id===t.payload}));e.selectedPost=n[0]}},extraReducers:function(e){e.addCase(P.pending,(function(e){e.status="loading"})).addCase(P.fulfilled,(function(e,t){e.status="idle",e.posts=t.payload}))}}),S=T.actions.setSelectedPost,E=function(e){return e.postsManager.posts},I=function(e){return e.postsManager.selectedPost},R=T.reducer,_=Object(h.c)({name:"EditPost",initialState:{post:null,status:"idle"},reducers:{},extraReducers:function(e){e.addCase(y.pending,(function(e){e.status="loading"})).addCase(y.fulfilled,(function(e){e.status="idle"})).addCase(C.pending,(function(e){e.status="loading"})).addCase(C.fulfilled,(function(e){e.status="idle"})).addCase(k.pending,(function(e){e.status="loading"})).addCase(k.fulfilled,(function(e){e.status="idle"}))}}).reducer,N=Object(h.a)({reducer:{editPost:_,postsManager:R}}),A=n(858),M=n(325),D=n(176),U=n.n(D),W=n(210),B=n(309),L=function(e){var t=e.safeDirection,n=e.safePadding,a=e.safeSpacing,i=e.safeFillContainer;return Object(W.a)((function(e){return Object(B.a)({root:{display:"flex",flexDirection:t,flexWrap:"wrap",padding:n,marginRight:"column"===t?-a:0,marginBottom:"row"===t?-a:0,width:"100%"},withBackground:{background:e.palette.background.paper},mainColumn:{margin:"auto !important",maxWidth:e.breakpoints.values.lg},childColumn:{flex:i?"1":"unset",flexDirection:t,marginBottom:a,"& :last-of-type":{marginBottom:0}},childRow:{flex:i?"1":"unset",flexDirection:t,marginBottom:a,marginRight:a,"& :last-of-type":{marginRight:0}}})}))},F=n(47),H=n(8),J=function e(t){var n=t.direction,r=t.padding,c=t.spacing,o=t.background,s=(t.elevation,t.fillContainer),l=t.mainColumn,d=t.children,u=n||"column",h=r?function(e){switch(e){case"0":case 0:return"0";case"16":case 16:return"16px";case"32":case 32:return"32px";default:return"0"}}(r):"0",f=c||0,b=o||!1,j=s||!1,p=l||!1,g=Object(F.a)(),m=L({safeDirection:u,safeFillContainer:j,safePadding:h,safeSpacing:f})(g),O=a.Children.map(d,(function(t){if(null!==t)return i.a.isValidElement(t)&&t.type===e?t:Object(H.jsx)("div",{className:U()(u&&"row"===u?m.childRow:m.childColumn,b&&m.withBackground),children:t})}));return Object(H.jsx)("div",{className:U()(m.root,u&&"row"===u?m.childRow:m.childColumn,b&&m.withBackground,p&&m.mainColumn),children:O})},G=n(852),V=n(853),z=n(854),Y=n(851),q=n(101),K=function(e){var t=e.children,n=e.disabled,a=e.target,i=e.url;return Object(H.jsx)(Y.a,{href:i,target:a,children:Object(H.jsx)(q.a,{disabled:n,children:t})})},$=function(){return Object(H.jsx)(H.Fragment,{children:Object(H.jsx)(G.a,{color:"secondary",elevation:0,children:Object(H.jsx)(J,{mainColumn:!0,children:Object(H.jsx)(V.a,{variant:"dense",children:Object(H.jsx)(K,{children:Object(H.jsx)(z.a,{color:"primary"}),url:x.HOME})})})})})},Q=n(175),X=n(27),Z=n(10),ee=n(89),te=function(e){var t=e.actions,n=Object(a.useState)(!1),i=Object(Z.a)(n,2),r=i[0],c=i[1];return Object(H.jsx)(J,{spacing:8,direction:"row",children:t.map((function(e,t){return e.href?r?Object(H.jsx)(X.a,{to:{pathname:e.href,state:N.getState()}}):Object(H.jsx)(ee.a,{variant:"contained",color:"primary",onClick:function(){return c(!0)},children:e.label},t):0===t?Object(H.jsx)(ee.a,{variant:"contained",color:"primary",onClick:e.callback,children:e.label},t):Object(H.jsx)(ee.a,{variant:"contained",color:"secondary",onClick:e.callback,children:e.label},t)}))})},ne=function(e){var t=e.title,n=e.actions;return Object(H.jsxs)(J,{spacing:32,padding:32,background:!0,elevation:!0,children:[Object(H.jsx)(M.a,{variant:"h2",children:t}),n&&Object(H.jsx)(te,{actions:n})]})},ae=function(e){var t=e.children;return Object(H.jsx)(J,{spacing:32,padding:32,direction:"column",background:!0,elevation:!0,children:t})},ie=[{href:x.CREATE_POST,label:"Create New Post"}],re=n(314),ce=function(e){var t=e.id;return[{href:x.EDIT_POST,label:"Edit"},{callback:function(){N.dispatch(k(t))},label:"Delete"}]},oe=[{field:"postTitle",headerName:"Post Title",width:160},{field:"friendlyCreateDate",headerName:"Created",width:240},{field:"thumbnailUrl",headerName:"Thumbnail Image Url",width:160},{field:"postContent",headerName:"Post Content",width:600}],se=Object(W.a)({table:{height:432}}),le=function(){return Object(o.b)()},de=o.c,ue=function(){var e=le(),t=de(E),n=de(I),a=t.map((function(e){return{id:e._id,postContent:e.content,postTitle:e.title,friendlyCreateDate:e.friendly_create_date,thumbnailUrl:e.thumbnailImage}})),i=se();return t?Object(H.jsxs)(J,{spacing:16,children:[n&&Object(H.jsx)(te,{actions:ce({id:n._id})}),Object(H.jsx)("div",{className:i.table,children:Object(H.jsx)(re.a,{columns:oe,rows:a,pageSize:6,onRowClick:function(t){e(S(t.id))}})})]}):null},he={footer:{copyright:"Copyright 2021 hmm.xd"},postManager:{editPost:{createPost:"Create post",editPost:"Edit post",updatePost:"Update post"},header:"Posts manager",managePosts:"Manage your posts",managePostsDesc:"Here you can make changes to your posts, arrange them or delete them."}},fe=function(){var e=le(),t=he.postManager;return Object(a.useEffect)((function(){e(P())})),Object(H.jsxs)(J,{spacing:32,children:[Object(H.jsx)(ne,{title:t.header,actions:ie}),Object(H.jsx)(ae,{children:Object(H.jsx)(J,{spacing:32,children:Object(H.jsxs)(J,{spacing:16,children:[Object(H.jsx)(M.a,{variant:"h4",children:t.managePosts}),Object(H.jsx)(M.a,{variant:"body1",children:t.managePostsDesc}),Object(H.jsx)(ue,{})]})})})]})},be=n(191),je=n(180),pe=n.n(je),ge=n(320),me=n.n(ge),Oe=n(323),ve=function(e){var t=e.isCreate,n=e.isEdit,a=e.selectedPost,i=le();return Object(Oe.a)({initialValues:n&&a?{content:a.content,thumbnailImage:a.thumbnailImage,title:a.title,"images[0]":a.images[0]}:{content:"",thumbnailImage:"",title:"","images[0]":""},onSubmit:function(e){var n=e,r={id:a?a._id:"id_unknown",post:e};i(t?y(n):C(r))}})},xe=[{href:x.HOME,label:"Back"}],we=Object(W.a)((function(e){return Object(B.a)({editor:{"& > div":{minHeight:"100vh",overflowY:"scroll",padding:32},height:"100vh",overflowY:"hidden"}})})),Pe=function(e){var t=e.usage,n=Object(o.c)(I),a="create"===t,i=ve({isCreate:a,isEdit:"edit"===t,selectedPost:n}),r=he.postManager.editPost,c=a?r.createPost:r.editPost,s=a?r.createPost:r.updatePost,l=Object(F.a)(),d=we(l);return Object(H.jsxs)(J,{spacing:32,children:[Object(H.jsx)(ne,{title:c,actions:xe}),Object(H.jsx)("form",{onSubmit:i.handleSubmit,className:"form",children:Object(H.jsxs)(J,{spacing:16,children:[Object(H.jsx)(be.a,{onChange:i.handleChange,id:"title",name:"title",type:"title",value:i.values.title,variant:"outlined",label:"Title",required:!0,fullWidth:!0}),Object(H.jsx)(be.a,{onChange:i.handleChange,id:"thumbnailImage",name:"thumbnailImage",type:"thumbnailImage",value:i.values.thumbnailImage,variant:"outlined",label:"Thumbnail Image URL",fullWidth:!0}),Object(H.jsx)(me.a,{appKey:"a0kj2d0xe9aw6se",success:function(e){return window.navigator.clipboard.writeText(e[0].link)},cancel:function(){return console.log("closed")},multiselect:!0,children:Object(H.jsx)(ee.a,{type:"button",children:"Dropbox"})}),Object(H.jsx)(pe.a,{className:d.editor,defaultValue:i.values.content,dark:!0,autoFocus:!0,onChange:function(e){i.values.content=e()}}),Object(H.jsx)(ee.a,{fullWidth:!0,variant:"outlined",color:"primary",type:"submit",size:"large",children:s}),Object(H.jsx)(pe.a,{readOnly:!0,value:i.values.content,dark:!0,className:d.editor})]})})]})},ye=function(){return Object(H.jsx)(Q.a,{children:Object(H.jsxs)(X.d,{children:[Object(H.jsx)(X.b,{exact:!0,path:x.CREATE_POST,children:Object(H.jsx)(Pe,{usage:"create"})}),Object(H.jsx)(X.b,{exact:!0,path:x.EDIT_POST,children:Object(H.jsx)(Pe,{usage:"edit"})}),Object(H.jsx)(X.b,{exact:!0,path:x.HOME,children:Object(H.jsx)(fe,{})})]})})},Ce=function(){return Object(H.jsxs)(H.Fragment,{children:[Object(H.jsx)(A.a,{}),Object(H.jsxs)(J,{spacing:80,mainColumn:!0,children:[Object(H.jsx)($,{}),Object(H.jsx)(ye,{}),Object(H.jsx)(J,{spacing:32,padding:32,background:!0,children:Object(H.jsx)(M.a,{variant:"caption",children:he.footer.copyright})})]})]})},ke=n(93),Te=Object(ke.a)({overrides:{MuiIcon:{colorPrimary:{color:"#80d8ff"}},MuiToolbar:{dense:{justifyContent:"right"}}},palette:{primary:{contrastText:"#1b1b1b",main:"#80d8ff"},secondary:{contrastText:"#efefef",main:"#1b1b1b"},background:{default:"#1b1b1b",paper:"#2b2b2b"},text:{primary:"#eeeeee",secondary:"#dddddd"}},typography:{fontFamily:["Poppins","sans-serif"].join(",")}});n(801);c.a.render(Object(H.jsx)(i.a.StrictMode,{children:Object(H.jsx)(o.a,{store:N,children:Object(H.jsx)(s.a,{theme:Te,children:Object(H.jsx)(Ce,{})})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/the-cms-public",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/the-cms-public","/service-worker.js");l?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):d(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):d(t,e)}))}}()}},[[802,1,2]]]);
//# sourceMappingURL=main.dfa3bbd8.chunk.js.map